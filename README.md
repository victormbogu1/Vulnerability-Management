# Nessus Essentials Vulnerability Management Lab
## Description
This guide explains how I set up a virtual machine environment using Hyper-V with Windows 10. The purpose of this project was to gain hands-on experience with Nessus Essentials, specifically in vulnerability scanning and remediation. The project demonstrates two critical steps in the Vulnerability Management Lifecycle. I utilized Nessus Essentials to scan local VMs hosted on Hyper-V, carried out credentialed scans to identify vulnerabilities, remediated some of these issues, and then performed a rescan to verify the effectiveness of the remediation. It's important to note that vulnerability management, a key aspect of computer and network security, should not be confused with vulnerability assessment.
## Languages and Utilities Used
  + Nessus Essential
  + CMD
## Environments Used
  + Hyper-V
  + Windows 10
## Links
  + [VirtualBox](https://www.virtualbox.org/wiki/Downloads)
  + [Nessus](https://www.tenable.com/products/nessus/nessus-essentials)
## Program walk-through

The initial task involves obtaining Nessus Essentials, the vulnerability management software I selected. Given that the download duration is lengthy, I can utilize this time efficiently by undertaking other activities, such as setting up and configuring Windows 10 on my Hyper-V hypervisor. Both these processes require a significant amount of time to complete.

[![Screenshot-2024-07-14-105421.png](https://i.postimg.cc/zfgSzqHH/Screenshot-2024-07-14-105421.png)](https://postimg.cc/CZwfJTNw)

The subsequent step involved configuring the Hyper-V virtual machine for network connectivity, ensuring it has access to the host machine's internet connection. This configuration was done after installing the operating system.

[![Screenshot-2024-07-16-110858.png](https://i.postimg.cc/hjMS6M7G/Screenshot-2024-07-16-110858.png)](https://postimg.cc/JDDVBNxw)

To handle vulnerabilities on the virtual environment, it's necessary to set the network adapter to bridged mode. This configuration connects the virtual machine to the same network as my physical machine, allowing Nessus to utilize Secure Server Login (SSL) for accessing the virtual environment. By bridging the network adapter, the virtual machine and Nessus can interact effortlessly, as they will reside on the identical local network. Consequently, both IP addresses will be within the same IP range as shown below


[![Screenshot-2024-07-16-112513.png](https://i.postimg.cc/J4xbKWnw/Screenshot-2024-07-16-112513.png)](https://postimg.cc/RN36VyKG)

I launched CMD to find the IP address of my VM named "Vmo," essential for conducting vulnerability scans with Nessus. Attempting to ping the VM from my host computer, I noticed the pings were timing out, indicating no successful communication. This issue arises because the VM's firewall is active, blocking all incoming connections a security measure typically beneficial but problematic for this lab's purpose. To proceed, I need to disable all three firewalls as shown below necessitating them to be turned Off temporarily for proper VM communication. 


[![Screenshot-2024-07-15-205242.png](https://i.postimg.cc/ZKG3HFtN/Screenshot-2024-07-15-205242.png)](https://postimg.cc/3dZdJGwr)



[![Screenshot-2024-07-15-205548.png](https://i.postimg.cc/VsBLpqCM/Screenshot-2024-07-15-205548.png)](https://postimg.cc/yWxHSSnY)

At this point, Nessus Essentials has completed its download. My initial task is to create a new scan, followed by selecting the Basic Network Scan option.

[![Screenshot-2024-07-15-210359.png](https://i.postimg.cc/1tb6dpnb/Screenshot-2024-07-15-210359.png)](https://postimg.cc/34Cd40ZZ)


[![Screenshot-2024-07-15-210445.png](https://i.postimg.cc/mZF7H6K4/Screenshot-2024-07-15-210445.png)](https://postimg.cc/WtTDRS2Y)


The newly created scan prompts me to name it and specify a target for scanning. I configure it to scan the IP address of the VM where the operating system was recently installed.


[![Screenshot-2024-07-16-190600.png](https://i.postimg.cc/23RN683V/Screenshot-2024-07-16-190600.png)](https://postimg.cc/1VHj7SGQ)


I initiate the newly created scan, and it promptly begins scanning for known vulnerabilities. Once the grey checkmark appears, indicating completion, I can review the scan results.

[![Screenshot-2024-07-15-211212.png](https://i.postimg.cc/430q8xZn/Screenshot-2024-07-15-211212.png)](https://postimg.cc/PLmSJhCk)

It displays 17 results, with 16 categorized as informational and 1 as low severity. In a production environment, these informational findings would typically be disregarded, often due to insufficient credentials rather than actual vulnerabilities.

[![Screenshot-2024-07-15-211318.png](https://i.postimg.cc/dQjn3VXd/Screenshot-2024-07-15-211318.png)](https://postimg.cc/MXX1rqzK)

Reviewing one of the informational results, I noticed that the "Target Credential Status By Authentication Protocol" was triggered because no credentials were supplied for this scan. The detection of SMB on port 445 indicates it's active, although without credentials, this represents a vulnerability scan with basic results

[![Screenshot-2024-07-15-212850.png](https://i.postimg.cc/hjqb4k1p/Screenshot-2024-07-15-212850.png)](https://postimg.cc/Mcdjdr4Q)

Next, I proceed to configure Hyper-V to enable authenticated scans and provide credentials to Nessus. To begin, I navigate to services.msc and initiate the process by enabling Remote Registry. This action ensures that Nessus can connect to the VM's registry and conduct thorough scans for vulnerabilities, including insecure connections or deprecated cipher suites. Additionally, ensuring that file and printer sharing is enabled allows for network access. These steps are based on Nessus recommendations for conducting credentialed scans, though there may be alternative methods available.

[![Screenshot-2024-07-15-213126.png](https://i.postimg.cc/66VwQCt0/Screenshot-2024-07-15-213126.png)](https://postimg.cc/mhrKXzcz)


[![Screenshot-2024-07-15-213459.png](https://i.postimg.cc/Dw0K5Dsj/Screenshot-2024-07-15-213459.png)](https://postimg.cc/bs7Mwmmk)


[![Screenshot-2024-07-15-213648.png](https://i.postimg.cc/VvmxtHmF/Screenshot-2024-07-15-213648.png)](https://postimg.cc/LYQQKDqq)

Following that, I proceed to disable User Account Control (UAC). This step is necessary because the VM is not part of a domain, requiring unconventional methods to ensure proper functionality. It's important to note that such actions are strictly for testing purposes and would not be implemented in a professional or production environment


[![Screenshot-2024-07-15-214456.png](https://i.postimg.cc/tgCJyDL8/Screenshot-2024-07-15-214456.png)](https://postimg.cc/zy68FwDk)


[![Screenshot-2024-07-15-214422.png](https://i.postimg.cc/K86sLs5g/Screenshot-2024-07-15-214422.png)](https://postimg.cc/Xrg86LmV)


Next, I'll navigate to the registry and add a key to facilitate Nessus connectivity by further disabling User Account Control (UAC). I'll access the local machine by browsing through the path: `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System`. Inside this location, I'll create a new DWORD value named `LocalAccountTokenFilterPolicy` and set its value to 1.

[![Screenshot-2024-07-15-214621.png](https://i.postimg.cc/Px46gfnm/Screenshot-2024-07-15-214621.png)](https://postimg.cc/cgvMYSHH)


[![Screenshot-2024-07-15-215146.png](https://i.postimg.cc/pLFs2JtV/Screenshot-2024-07-15-215146.png)](https://postimg.cc/hXKLsxjN)


[![Screenshot-2024-07-15-215407.png](https://i.postimg.cc/PxtyQGvN/Screenshot-2024-07-15-215407.png)](https://postimg.cc/mc57T5wG)

After making those changes, I need to restart the VM to ensure the modifications take effect

[![Screenshot-2024-07-15-215610.png](https://i.postimg.cc/XN1Ldzj7/Screenshot-2024-07-15-215610.png)](https://postimg.cc/XXF90xBT)

Having configured the registry, the next step is to return to Nessus and modify the scan settings. I need to include the credentials (username and password) for the VM to ensure Nessus can operate effectively. These credentials will enable Nessus to access and authenticate where necessary within the VM's registry

[![Screenshot-2024-07-15-215825.png](https://i.postimg.cc/HLm9TG23/Screenshot-2024-07-15-215825.png)](https://postimg.cc/4Y891Sjh)

[![Screenshot-2024-07-15-220244.png](https://i.postimg.cc/SRHc5HR6/Screenshot-2024-07-15-220244.png)](https://postimg.cc/9wt4w8G0)

After properly configuring the scan with the correct credentials, I initiate the scan once more

[![Screenshot-2024-07-15-220622.png](https://i.postimg.cc/9FqdTXgJ/Screenshot-2024-07-15-220622.png)](https://postimg.cc/qz46HrT3)

The latest scan has identified a significantly higher number of vulnerabilities compared to the initial scan, primarily because it was able to perform a deeper analysis of the VM using credentials. The top image represents the results of the new credentialed scan, while the bottom image shows the findings from the first non-credentialed scan. Many of the vulnerabilities detected are likely attributable to the outdated version of Windows 10 running on the VM


[![Screenshot-2024-07-15-224210.png](https://i.postimg.cc/7PRcw6TV/Screenshot-2024-07-15-224210.png)](https://postimg.cc/BtxNCJpL)


[![Screenshot-2024-07-15-211318.png](https://i.postimg.cc/dQjn3VXd/Screenshot-2024-07-15-211318.png)](https://postimg.cc/MXX1rqzK


Before proceeding to remediate these vulnerabilities, I'm going to install deprecated software on this computer, such as an outdated version of Firefox. Afterward, I'll run another scan with Nessus to see if it can detect these vulnerabilities


[![Screenshot-2024-07-15-225951.png](https://i.postimg.cc/7ZKSrC5P/Screenshot-2024-07-15-225951.png)](https://postimg.cc/bZ2ZQw04


[![Screenshot-2024-07-15-230157.png](https://i.postimg.cc/qq22Pj3W/Screenshot-2024-07-15-230157.png)](https://postimg.cc/n9cs7KT1)


After downloading a deprecated version of Firefox, I initiated another scan. The results revealed numerous new alerts and vulnerabilities related to Firefox, with 120 critical issues identified


[![Screenshot-2024-07-15-234039.png](https://i.postimg.cc/MZ1RK3nF/Screenshot-2024-07-15-234039.png)](https://postimg.cc/8sPsZHBR)


Here's a comparison between the scans to illustrate the progression of alerts and vulnerabilities:

Initial Scan (Non-Credentialed):

[![Screenshot-2024-07-15-212351.png](https://i.postimg.cc/kXkkF4J4/Screenshot-2024-07-15-212351.png)](https://postimg.cc/hf1yKK7W

Credentialed Scan Configured:

[![Screenshot-2024-07-15-224210.png](https://i.postimg.cc/7PRcw6TV/Screenshot-2024-07-15-224210.png)](https://postimg.cc/BtxNCJpL)

Scan after Installing Old Version of Firefox

[![Screenshot-2024-07-15-234039.png](https://i.postimg.cc/WtRXrdGc/Screenshot-2024-07-15-234039.png)](https://postimg.cc/n9k4fcS3)

This comparison highlights how vulnerabilities increased with each scan, particularly after installing the deprecated version of Firefox. It demonstrates the importance of regular updates and secure configurations in maintaining system integrity.

Showing what some of the alerts and vulnerabilites look like. We can see most of the Critical alerts are just from Firefox. 

[![Screenshot-2024-07-15-234300.png](https://i.postimg.cc/bwyFRtXq/Screenshot-2024-07-15-234300.png)](https://postimg.cc/KRWNG4vW)

[![Screenshot-2024-07-15-235955.png](https://i.postimg.cc/VkKZZk1n/Screenshot-2024-07-15-235955.png)](https://postimg.cc/gx6Kndx2)

Here's a description of what some of the alerts and vulnerabilities look like, focusing on critical alerts primarily attributed to Firefox:

Critical Alerts Overview:

Firefox Version Vulnerability: Multiple critical vulnerabilities have been identified in the outdated version of Firefox installed on the virtual machine.
Impact: These vulnerabilities pose a significant risk as they can potentially allow remote attackers to execute arbitrary code, escalate privileges, or compromise sensitive data.
Recommendations:
Update Firefox: Installing the latest version of Firefox with security patches can mitigate most of these vulnerabilities.
Remove Firefox: Alternatively, removing Firefox altogether eliminates the associated risks but may affect user functionality depending on dependencies.
Vulnerability Types:

Remote Code Execution: Allows attackers to execute malicious code remotely.
Privilege Escalation: Vulnerabilities that could enable unauthorized users to elevate their privileges.
Data Compromise: Risks related to unauthorized access to sensitive information.
Remediation Strategy:

Updating Software: Ensure all software, including operating systems and applications like Firefox, are regularly updated to their latest secure versions.
Monitoring and Patching: Implement a robust patch management process to promptly apply security updates.
Risk Mitigation: Consider removing or restricting access to software or services that are no longer supported or pose a high security risk.
This approach aims to reduce the attack surface and strengthen the overall security posture of the virtual machine environment.


To begin the process of remediating vulnerabilities, I'll proceed by uninstalling Firefox. This action should promptly resolve many of these issues but every company has its own methods for remediating vulnerabilities.


[![Screenshot-2024-07-16-000437.png](https://i.postimg.cc/g0rSCbk5/Screenshot-2024-07-16-000437.png)](https://postimg.cc/WDLwZKZ6)

After a few restarts, Windows is finally updated. I proceed to run another Nessus scan to verify if the steps I took to remediate some of the alerts have been effective

[![Screenshot-2024-07-16-001244.png](https://i.postimg.cc/s2tcbBLQ/Screenshot-2024-07-16-001244.png)](https://postimg.cc/GBxGypdd)

[![Screenshot-2024-07-16-001342.png](https://i.postimg.cc/ydcPK1qf/Screenshot-2024-07-16-001342.png)](https://postimg.cc/cg1YMNLY)

[![Screenshot-2024-07-16-011854.png](https://i.postimg.cc/4NJ5CRW5/Screenshot-2024-07-16-011854.png)](https://postimg.cc/5jRvvTdY)

Here is a final comparison showing the results after applying remediations and continuous updates during this lab. The images below demonstrate the scan conducted after remediation efforts. As you can see, the vulnerabilities have been successfully addressed, and the computer is now secure.

After Remediation

[![Screenshot-2024-07-16-020056.png](https://i.postimg.cc/sD65tQQj/Screenshot-2024-07-16-020056.png)](https://postimg.cc/VdtStNWp)

[![Screenshot-2024-07-16-194745.png](https://i.postimg.cc/hGbY81v4/Screenshot-2024-07-16-194745.png)](https://postimg.cc/KKjQxLtC)

[![Screenshot-2024-07-16-194825.png](https://i.postimg.cc/HnJ3NwYy/Screenshot-2024-07-16-194825.png)](https://postimg.cc/0KspMJJk)
